<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 資料視覺化分析 | R 資料科學與統計</title>
  <meta name="description" content="Chapter 5 資料視覺化分析 | R 資料科學與統計" />
  <meta name="generator" content="bookdown 0.20 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 資料視覺化分析 | R 資料科學與統計" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Chapter 5 資料視覺化分析 | R 資料科學與統計" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 資料視覺化分析 | R 資料科學與統計" />
  
  <meta name="twitter:description" content="Chapter 5 資料視覺化分析 | R 資料科學與統計" />
  

<meta name="author" content="Jeff Lin" />


<meta name="date" content="2020-10-15" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="datainout.html"/>
<link rel="next" href="basicfunctiuon.html"/>
<script src="libs/header-attrs-2.3/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Prerequisites</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> R 語言基本概論</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#下載與安裝-r"><i class="fa fa-check"></i><b>1.1</b> 下載與安裝 R</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#下載與安裝-rsudio"><i class="fa fa-check"></i><b>1.2</b> 下載與安裝 RSudio</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#簡單實例"><i class="fa fa-check"></i><b>1.3</b> 簡單實例</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#物件-object"><i class="fa fa-check"></i><b>1.4</b> 物件 Object</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#使用指令"><i class="fa fa-check"></i><b>1.5</b> 使用指令</a></li>
<li class="chapter" data-level="1.6" data-path="intro.html"><a href="intro.html#查詢顯示物件與刪除物件"><i class="fa fa-check"></i><b>1.6</b> 查詢顯示物件與刪除物件</a></li>
<li class="chapter" data-level="1.7" data-path="intro.html"><a href="intro.html#程式中止操作"><i class="fa fa-check"></i><b>1.7</b> 程式中止操作</a></li>
<li class="chapter" data-level="1.8" data-path="intro.html"><a href="intro.html#工作目錄"><i class="fa fa-check"></i><b>1.8</b> 工作目錄</a></li>
<li class="chapter" data-level="1.9" data-path="intro.html"><a href="intro.html#程式編輯軟體與整合系統-rstudio"><i class="fa fa-check"></i><b>1.9</b> 程式編輯軟體與整合系統 RStudio</a></li>
<li class="chapter" data-level="1.10" data-path="intro.html"><a href="intro.html#函式-function"><i class="fa fa-check"></i><b>1.10</b> 函式 Function</a></li>
<li class="chapter" data-level="1.11" data-path="intro.html"><a href="intro.html#套件-packages"><i class="fa fa-check"></i><b>1.11</b> 套件 Packages</a></li>
<li class="chapter" data-level="1.12" data-path="intro.html"><a href="intro.html#解說與輔助文件"><i class="fa fa-check"></i><b>1.12</b> 解說與輔助文件</a></li>
<li class="chapter" data-level="1.13" data-path="intro.html"><a href="intro.html#地區語系與時區"><i class="fa fa-check"></i><b>1.13</b> 地區語系與時區</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="vector.html"><a href="vector.html"><i class="fa fa-check"></i><b>2</b> 向量</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vector.html"><a href="vector.html#向量"><i class="fa fa-check"></i><b>2.1</b> 向量</a></li>
<li class="chapter" data-level="2.2" data-path="vector.html"><a href="vector.html#向量基本資料類型"><i class="fa fa-check"></i><b>2.2</b> 向量基本資料類型</a></li>
<li class="chapter" data-level="2.3" data-path="vector.html"><a href="vector.html#向量產生函式-c"><i class="fa fa-check"></i><b>2.3</b> 向量產生函式 <code>c()</code></a></li>
<li class="chapter" data-level="2.4" data-path="vector.html"><a href="vector.html#向量基本運算操作符號"><i class="fa fa-check"></i><b>2.4</b> 向量基本運算操作符號</a></li>
<li class="chapter" data-level="2.5" data-path="vector.html"><a href="vector.html#向量基本算數操作"><i class="fa fa-check"></i><b>2.5</b> 向量基本算數操作</a></li>
<li class="chapter" data-level="2.6" data-path="vector.html"><a href="vector.html#向量關係比較操作"><i class="fa fa-check"></i><b>2.6</b> 向量關係比較操作</a></li>
<li class="chapter" data-level="2.7" data-path="vector.html"><a href="vector.html#向量邏輯操作"><i class="fa fa-check"></i><b>2.7</b> 向量邏輯操作</a></li>
<li class="chapter" data-level="2.8" data-path="vector.html"><a href="vector.html#向量元素命名"><i class="fa fa-check"></i><b>2.8</b> 向量元素命名</a></li>
<li class="chapter" data-level="2.9" data-path="vector.html"><a href="vector.html#向量下標與索引-inxex"><i class="fa fa-check"></i><b>2.9</b> 向量下標與索引 Inxex</a></li>
<li class="chapter" data-level="2.10" data-path="vector.html"><a href="vector.html#遺失值-缺失值-missing-values"><i class="fa fa-check"></i><b>2.10</b> 遺失值 (缺失值) Missing Values</a></li>
<li class="chapter" data-level="2.11" data-path="vector.html"><a href="vector.html#因子物件與類別變數-factor"><i class="fa fa-check"></i><b>2.11</b> 因子物件與類別變數 Factor</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="dataobject.html"><a href="dataobject.html"><i class="fa fa-check"></i><b>3</b> 資料物件</a>
<ul>
<li class="chapter" data-level="3.1" data-path="dataobject.html"><a href="dataobject.html#矩陣物件-matrix"><i class="fa fa-check"></i><b>3.1</b> 矩陣物件 Matrix</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="dataobject.html"><a href="dataobject.html#矩陣函式-matrix"><i class="fa fa-check"></i><b>3.1.1</b> 矩陣函式 matrix()</a></li>
<li class="chapter" data-level="3.1.2" data-path="dataobject.html"><a href="dataobject.html#矩陣命名-dimnames"><i class="fa fa-check"></i><b>3.1.2</b> 矩陣命名 dimnames()</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="dataobject.html"><a href="dataobject.html#矩陣的下標與索引-matrix-index"><i class="fa fa-check"></i><b>3.2</b> 矩陣的下標與索引 Matrix Index</a></li>
<li class="chapter" data-level="3.3" data-path="dataobject.html"><a href="dataobject.html#向量與矩陣的合併-rbind-與-cbind"><i class="fa fa-check"></i><b>3.3</b> 向量與矩陣的合併: rbind() 與 cbind()</a></li>
<li class="chapter" data-level="3.4" data-path="dataobject.html"><a href="dataobject.html#陣列物件-array"><i class="fa fa-check"></i><b>3.4</b> 陣列物件 Array</a></li>
<li class="chapter" data-level="3.5" data-path="dataobject.html"><a href="dataobject.html#列表物件-list"><i class="fa fa-check"></i><b>3.5</b> 列表物件 List</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="dataobject.html"><a href="dataobject.html#列表函式-list"><i class="fa fa-check"></i><b>3.5.1</b> 列表函式 list()</a></li>
<li class="chapter" data-level="3.5.2" data-path="dataobject.html"><a href="dataobject.html#列表的下標與索引-list-index"><i class="fa fa-check"></i><b>3.5.2</b> 列表的下標與索引 List Index</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="dataobject.html"><a href="dataobject.html#資料框架-data-frame"><i class="fa fa-check"></i><b>3.6</b> 資料框架 Data Frame</a></li>
<li class="chapter" data-level="3.7" data-path="dataobject.html"><a href="dataobject.html#資料框架函式-data.frame"><i class="fa fa-check"></i><b>3.7</b> 資料框架函式 data.frame()</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="dataobject.html"><a href="dataobject.html#資料框架的下標與索引-data-frame-index"><i class="fa fa-check"></i><b>3.7.1</b> 資料框架的下標與索引 Data Frame Index</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="datainout.html"><a href="datainout.html"><i class="fa fa-check"></i><b>4</b> 資料輸入與輸出</a>
<ul>
<li class="chapter" data-level="4.1" data-path="datainout.html"><a href="datainout.html#資料框架"><i class="fa fa-check"></i><b>4.1</b> 資料框架</a></li>
<li class="chapter" data-level="4.2" data-path="datainout.html"><a href="datainout.html#輸入外部-ascii-資料檔案至-r-資料框架-空白分隔"><i class="fa fa-check"></i><b>4.2</b> 輸入外部 ASCII 資料檔案至 R 資料框架: 空白分隔</a></li>
<li class="chapter" data-level="4.3" data-path="datainout.html"><a href="datainout.html#輸入外部-ascii-資料檔案至-r-資料框架-逗號分隔"><i class="fa fa-check"></i><b>4.3</b> 輸入外部 ASCII 資料檔案至 R 資料框架: 逗號分隔</a></li>
<li class="chapter" data-level="4.4" data-path="datainout.html"><a href="datainout.html#r-內建資料框架"><i class="fa fa-check"></i><b>4.4</b> R 內建資料框架</a></li>
<li class="chapter" data-level="4.5" data-path="datainout.html"><a href="datainout.html#輸出-r-資料"><i class="fa fa-check"></i><b>4.5</b> 輸出 {R} 資料</a></li>
<li class="chapter" data-level="4.6" data-path="datainout.html"><a href="datainout.html#儲存-r-格式資料檔"><i class="fa fa-check"></i><b>4.6</b> 儲存 {R} 格式資料檔</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dataviz.html"><a href="dataviz.html"><i class="fa fa-check"></i><b>5</b> 資料視覺化分析</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dataviz.html"><a href="dataviz.html#視覺化分析原則"><i class="fa fa-check"></i><b>5.1</b> 視覺化分析原則</a></li>
<li class="chapter" data-level="5.2" data-path="dataviz.html"><a href="dataviz.html#繪圖套件-ggplot2"><i class="fa fa-check"></i><b>5.2</b> 繪圖套件 ggplot2</a></li>
<li class="chapter" data-level="5.3" data-path="dataviz.html"><a href="dataviz.html#類別變數"><i class="fa fa-check"></i><b>5.3</b> 類別變數</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="dataviz.html"><a href="dataviz.html#單一類別變數"><i class="fa fa-check"></i><b>5.3.1</b> 單一類別變數</a></li>
<li class="chapter" data-level="5.3.2" data-path="dataviz.html"><a href="dataviz.html#多類別變數"><i class="fa fa-check"></i><b>5.3.2</b> 多類別變數</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="dataviz.html"><a href="dataviz.html#連續變數"><i class="fa fa-check"></i><b>5.4</b> 連續變數</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="dataviz.html"><a href="dataviz.html#單連續變數"><i class="fa fa-check"></i><b>5.4.1</b> 單連續變數</a></li>
<li class="chapter" data-level="5.4.2" data-path="dataviz.html"><a href="dataviz.html#二連續變數"><i class="fa fa-check"></i><b>5.4.2</b> 二連續變數</a></li>
<li class="chapter" data-level="5.4.3" data-path="dataviz.html"><a href="dataviz.html#三連續變數"><i class="fa fa-check"></i><b>5.4.3</b> 三連續變數</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="dataviz.html"><a href="dataviz.html#混合變數"><i class="fa fa-check"></i><b>5.5</b> 混合變數</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="dataviz.html"><a href="dataviz.html#一連續-一類別"><i class="fa fa-check"></i><b>5.5.1</b> 一連續 + 一類別</a></li>
<li class="chapter" data-level="5.5.2" data-path="dataviz.html"><a href="dataviz.html#二連續-一類別"><i class="fa fa-check"></i><b>5.5.2</b> 二連續 + 一類別</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="dataviz.html"><a href="dataviz.html#分組繪圖"><i class="fa fa-check"></i><b>5.6</b> 分組繪圖</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html"><i class="fa fa-check"></i><b>6</b> 基本函式</a>
<ul>
<li class="chapter" data-level="6.1" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#函式語法"><i class="fa fa-check"></i><b>6.1</b> 函式語法</a></li>
<li class="chapter" data-level="6.2" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#檢視的函式原始碼定義"><i class="fa fa-check"></i><b>6.2</b> 檢視的函式原始碼定義</a></li>
<li class="chapter" data-level="6.3" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#數列函式"><i class="fa fa-check"></i><b>6.3</b> 數列函式</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#數列函式-seq-與-sequence"><i class="fa fa-check"></i><b>6.3.1</b> 數列函式: seq() 與 sequence()</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#重複元素函式-rep"><i class="fa fa-check"></i><b>6.4</b> 重複元素函式: rep()</a></li>
<li class="chapter" data-level="6.5" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#算數函式-arithmetic-computing-function"><i class="fa fa-check"></i><b>6.5</b> 算數函式 Arithmetic Computing Function</a></li>
<li class="chapter" data-level="6.6" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#組合與階乘函式-choose-與-factorial"><i class="fa fa-check"></i><b>6.6</b> 組合與階乘函式: choose() 與 factorial()</a></li>
<li class="chapter" data-level="6.7" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#選擇資料函式-all-any-which"><i class="fa fa-check"></i><b>6.7</b> 選擇資料函式: all(), any(), which()</a></li>
<li class="chapter" data-level="6.8" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#排序函式-ranking-and-sorting"><i class="fa fa-check"></i><b>6.8</b> 排序函式 Ranking and Sorting</a></li>
<li class="chapter" data-level="6.9" data-path="basicfunctiuon.html"><a href="basicfunctiuon.html#物件查看與強制轉換函式"><i class="fa fa-check"></i><b>6.9</b> 物件查看與強制轉換函式</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="basicstat.html"><a href="basicstat.html"><i class="fa fa-check"></i><b>7</b> 基本統計函式</a>
<ul>
<li class="chapter" data-level="7.1" data-path="basicstat.html"><a href="basicstat.html#敘述統計函式"><i class="fa fa-check"></i><b>7.1</b> 敘述統計函式</a></li>
<li class="chapter" data-level="7.2" data-path="basicstat.html"><a href="basicstat.html#類別資料表格函數"><i class="fa fa-check"></i><b>7.2</b> 類別資料表格函數</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="basicstat.html"><a href="basicstat.html#列聯表函式-table-xtabs"><i class="fa fa-check"></i><b>7.2.1</b> 列聯表函式: table(), xtabs()</a></li>
<li class="chapter" data-level="7.2.2" data-path="basicstat.html"><a href="basicstat.html#列聯表函式-ftable"><i class="fa fa-check"></i><b>7.2.2</b> 列聯表函式: ftable()</a></li>
<li class="chapter" data-level="7.2.3" data-path="basicstat.html"><a href="basicstat.html#列聯表函式-margin.table-prop.table"><i class="fa fa-check"></i><b>7.2.3</b> 列聯表函式: margin.table(), prop.table()</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="basicstat.html"><a href="basicstat.html#機率函式與亂數生成函式"><i class="fa fa-check"></i><b>7.3</b> 機率函式與亂數生成函式</a></li>
<li class="chapter" data-level="7.4" data-path="basicstat.html"><a href="basicstat.html#隨機抽樣函式-sample"><i class="fa fa-check"></i><b>7.4</b> 隨機抽樣函式 sample()</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="basictidy.html"><a href="basictidy.html"><i class="fa fa-check"></i><b>8</b> 資料基本處理</a>
<ul>
<li class="chapter" data-level="8.1" data-path="basictidy.html"><a href="basictidy.html#資料輸入套件-readr"><i class="fa fa-check"></i><b>8.1</b> 資料輸入套件 readr</a></li>
<li class="chapter" data-level="8.2" data-path="basictidy.html"><a href="basictidy.html#整潔資料-tidy-data"><i class="fa fa-check"></i><b>8.2</b> 整潔資料 Tidy Data</a></li>
<li class="chapter" data-level="8.3" data-path="basictidy.html"><a href="basictidy.html#tibble-與-data-frame"><i class="fa fa-check"></i><b>8.3</b> Tibble 與 Data Frame</a></li>
<li class="chapter" data-level="8.4" data-path="basictidy.html"><a href="basictidy.html#資料流動管道運算指令-pipe"><i class="fa fa-check"></i><b>8.4</b> 資料流動管道運算指令 Pipe</a></li>
<li class="chapter" data-level="8.5" data-path="basictidy.html"><a href="basictidy.html#資料檢視函式-glimpse"><i class="fa fa-check"></i><b>8.5</b> 資料檢視函式 glimpse()</a></li>
<li class="chapter" data-level="8.6" data-path="basictidy.html"><a href="basictidy.html#資料處裡-dplyr-套件"><i class="fa fa-check"></i><b>8.6</b> 資料處裡 dplyr 套件</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="basictidy.html"><a href="basictidy.html#選擇個體函式-filter"><i class="fa fa-check"></i><b>8.6.1</b> 選擇個體函式 <code>filter()</code></a></li>
<li class="chapter" data-level="8.6.2" data-path="basictidy.html"><a href="basictidy.html#依據變數值排序函式-arrange"><i class="fa fa-check"></i><b>8.6.2</b> 依據變數值排序函式 <code>arrange()</code></a></li>
<li class="chapter" data-level="8.6.3" data-path="basictidy.html"><a href="basictidy.html#選擇變數或欄位子集函式-select"><i class="fa fa-check"></i><b>8.6.3</b> 選擇變數或欄位子集函式 <code>select()</code></a></li>
<li class="chapter" data-level="8.6.4" data-path="basictidy.html"><a href="basictidy.html#變數轉換函式-mutate"><i class="fa fa-check"></i><b>8.6.4</b> 變數轉換函式 <code>mutate()</code></a></li>
<li class="chapter" data-level="8.6.5" data-path="basictidy.html"><a href="basictidy.html#隨機抽樣函式-sample_n-與-sample_frac"><i class="fa fa-check"></i><b>8.6.5</b> 隨機抽樣函式 <code>sample_n()</code> 與 <code>sample_frac()</code></a></li>
<li class="chapter" data-level="8.6.6" data-path="basictidy.html"><a href="basictidy.html#選出明顯不同個體函式-distinct-與-n_distinct"><i class="fa fa-check"></i><b>8.6.6</b> 選出明顯不同個體函式 <code>distinct()</code> 與 <code>n_distinct()</code></a></li>
<li class="chapter" data-level="8.6.7" data-path="basictidy.html"><a href="basictidy.html#利用橫列指標選出個體函式-slice"><i class="fa fa-check"></i><b>8.6.7</b> 利用橫列指標選出個體函式 <code>slice()</code></a></li>
<li class="chapter" data-level="8.6.8" data-path="basictidy.html"><a href="basictidy.html#計算常見統計量函式-summarise"><i class="fa fa-check"></i><b>8.6.8</b> 計算常見統計量函式 <code>summarise()</code></a></li>
<li class="chapter" data-level="8.6.9" data-path="basictidy.html"><a href="basictidy.html#資料分組操作函式-group_by"><i class="fa fa-check"></i><b>8.6.9</b> 資料分組操作函式 <code>group_by()</code></a></li>
<li class="chapter" data-level="8.6.10" data-path="basictidy.html"><a href="basictidy.html#多變數計算統計量函式-summarise_all"><i class="fa fa-check"></i><b>8.6.10</b> 多變數計算統計量函式 <code>summarise_all()</code></a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="basictidy.html"><a href="basictidy.html#資料聯集與交集函式"><i class="fa fa-check"></i><b>8.7</b> 資料聯集與交集函式</a></li>
<li class="chapter" data-level="8.8" data-path="basictidy.html"><a href="basictidy.html#資料合併函式"><i class="fa fa-check"></i><b>8.8</b> 資料合併函式</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="purrr.html"><a href="purrr.html"><i class="fa fa-check"></i><b>9</b> 資料迭代處理</a>
<ul>
<li class="chapter" data-level="9.1" data-path="purrr.html"><a href="purrr.html#對資料變數欄位-columns-進行相同操作"><i class="fa fa-check"></i><b>9.1</b> 對資料變數欄位 (columns) 進行相同操作</a></li>
<li class="chapter" data-level="9.2" data-path="purrr.html"><a href="purrr.html#對資料個體列位-rows-進行相同操作"><i class="fa fa-check"></i><b>9.2</b> 對資料個體列位 (rows) 進行相同操作</a></li>
<li class="chapter" data-level="9.3" data-path="purrr.html"><a href="purrr.html#依據條件進行變數轉換"><i class="fa fa-check"></i><b>9.3</b> 依據條件進行變數轉換</a></li>
<li class="chapter" data-level="9.4" data-path="purrr.html"><a href="purrr.html#r-資料物件操作函式-apply"><i class="fa fa-check"></i><b>9.4</b> {R} 資料物件操作函式: apply()</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="stringr.html"><a href="stringr.html"><i class="fa fa-check"></i><b>10</b> 文字與字串資料處理</a>
<ul>
<li class="chapter" data-level="10.1" data-path="stringr.html"><a href="stringr.html#文字與字串資料基礎"><i class="fa fa-check"></i><b>10.1</b> 文字與字串資料基礎</a></li>
<li class="chapter" data-level="10.2" data-path="stringr.html"><a href="stringr.html#套件-stringr"><i class="fa fa-check"></i><b>10.2</b> 套件 stringr</a></li>
<li class="chapter" data-level="10.3" data-path="stringr.html"><a href="stringr.html#合併文字或字串-str_c"><i class="fa fa-check"></i><b>10.3</b> 合併文字或字串 str_c()</a></li>
<li class="chapter" data-level="10.4" data-path="stringr.html"><a href="stringr.html#取出文字或字串向量中的部分元素-str_sub"><i class="fa fa-check"></i><b>10.4</b> 取出文字或字串向量中的部分元素 str_sub()</a></li>
<li class="chapter" data-level="10.5" data-path="stringr.html"><a href="stringr.html#語言設定地區與文字大小寫排序"><i class="fa fa-check"></i><b>10.5</b> 語言設定地區與文字大小寫排序</a></li>
<li class="chapter" data-level="10.6" data-path="stringr.html"><a href="stringr.html#移除空白-加入空白-截斷文字-str_trim-與-str_pad"><i class="fa fa-check"></i><b>10.6</b> 移除空白, 加入空白, 截斷文字 <code>str_trim()</code> 與 <code>str_pad()</code></a></li>
<li class="chapter" data-level="10.7" data-path="stringr.html"><a href="stringr.html#尋找特定形式文字或字串"><i class="fa fa-check"></i><b>10.7</b> 尋找特定形式文字或字串</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="stringr.html"><a href="stringr.html#偵測函式-str_detect"><i class="fa fa-check"></i><b>10.7.1</b> 偵測函式 <code>str_detect()</code></a></li>
<li class="chapter" data-level="10.7.2" data-path="stringr.html"><a href="stringr.html#確認位置函式-str_detect"><i class="fa fa-check"></i><b>10.7.2</b> 確認位置函式 <code>str_detect()</code></a></li>
<li class="chapter" data-level="10.7.3" data-path="stringr.html"><a href="stringr.html#確認索引函式-str_subset-與-str_which"><i class="fa fa-check"></i><b>10.7.3</b> 確認索引函式 <code>str_subset()</code> 與 <code>str_which()</code></a></li>
<li class="chapter" data-level="10.7.4" data-path="stringr.html"><a href="stringr.html#取出函式-str_extract"><i class="fa fa-check"></i><b>10.7.4</b> 取出函式 <code>str_extract()</code></a></li>
<li class="chapter" data-level="10.7.5" data-path="stringr.html"><a href="stringr.html#配對函式-str_match"><i class="fa fa-check"></i><b>10.7.5</b> 配對函式 <code>str_match()</code></a></li>
<li class="chapter" data-level="10.7.6" data-path="stringr.html"><a href="stringr.html#替代置換函式-str_replace"><i class="fa fa-check"></i><b>10.7.6</b> 替代置換函式 <code>str_replace()</code></a></li>
<li class="chapter" data-level="10.7.7" data-path="stringr.html"><a href="stringr.html#分割函式-str_split"><i class="fa fa-check"></i><b>10.7.7</b> 分割函式 <code>str_split()</code></a></li>
</ul></li>
<li class="chapter" data-level="10.8" data-path="stringr.html"><a href="stringr.html#群組尋找特定形式的文字與字串"><i class="fa fa-check"></i><b>10.8</b> 群組尋找特定形式的文字與字串</a></li>
<li class="chapter" data-level="10.9" data-path="stringr.html"><a href="stringr.html#尋找連續重覆特定形式的文字與字串"><i class="fa fa-check"></i><b>10.9</b> 尋找連續重覆特定形式的文字與字串</a></li>
<li class="chapter" data-level="10.10" data-path="stringr.html"><a href="stringr.html#正規表示文字與字串-萬用字元"><i class="fa fa-check"></i><b>10.10</b> 正規表示文字與字串 (萬用字元)</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="lubridate.html"><a href="lubridate.html"><i class="fa fa-check"></i><b>11</b> 日期時間處理</a>
<ul>
<li class="chapter" data-level="11.1" data-path="lubridate.html"><a href="lubridate.html#lubridate-套件的日期時間"><i class="fa fa-check"></i><b>11.1</b> lubridate 套件的日期時間</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="lubridate.html"><a href="lubridate.html#從文字或字串轉換創件日期時間物件"><i class="fa fa-check"></i><b>11.1.1</b> 從文字或字串轉換創件日期時間物件</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="lubridate.html"><a href="lubridate.html#從date-time-資料個別成分-創件日期時間物件."><i class="fa fa-check"></i><b>11.2</b> 從date-time 資料個別成分, 創件日期時間物件.</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="lubridate.html"><a href="lubridate.html#從已經建立的其他資料物件創件日期時間物件"><i class="fa fa-check"></i><b>11.2.1</b> 從已經建立的其他資料物件創件日期時間物件</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="lubridate.html"><a href="lubridate.html#時區轉換"><i class="fa fa-check"></i><b>11.3</b> 時區轉換</a></li>
<li class="chapter" data-level="11.4" data-path="lubridate.html"><a href="lubridate.html#取出-date-time-資料的個別成分"><i class="fa fa-check"></i><b>11.4</b> 取出 date-time 資料的個別成分</a></li>
<li class="chapter" data-level="11.5" data-path="lubridate.html"><a href="lubridate.html#計算時間長度"><i class="fa fa-check"></i><b>11.5</b> 計算時間長度</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="lubridate.html"><a href="lubridate.html#duration-創建以秒計算的時間長度的物件"><i class="fa fa-check"></i><b>11.5.1</b> <code>duration</code> 創建以秒計算的時間長度的物件</a></li>
<li class="chapter" data-level="11.5.2" data-path="lubridate.html"><a href="lubridate.html#period-創建以人類文明的時間單位計算時間長度"><i class="fa fa-check"></i><b>11.5.2</b> <code>period</code> 創建以人類文明的時間單位計算時間長度</a></li>
<li class="chapter" data-level="11.5.3" data-path="lubridate.html"><a href="lubridate.html#interval-計算二個-date-time-物件之間的時間長度."><i class="fa fa-check"></i><b>11.5.3</b> <code>interval</code> 計算二個 date-time 物件之間的時間長度.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>12</b> Applications</a>
<ul>
<li class="chapter" data-level="12.1" data-path="applications.html"><a href="applications.html#example-one"><i class="fa fa-check"></i><b>12.1</b> Example one</a></li>
<li class="chapter" data-level="12.2" data-path="applications.html"><a href="applications.html#example-two"><i class="fa fa-check"></i><b>12.2</b> Example two</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="final-words.html"><a href="final-words.html"><i class="fa fa-check"></i><b>13</b> Final Words</a></li>
<li class="chapter" data-level="14" data-path="temp.html"><a href="temp.html"><i class="fa fa-check"></i><b>14</b> Temp</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R 資料科學與統計</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dataviz" class="section level1" number="5">
<h1><span class="header-section-number">Chapter 5</span> 資料視覺化分析</h1>
<p>繪圖文法是讓一個圖形容易思考, 合理討論與溝通的抽像規則.
Leland Wilkinson (1999),
<strong>The Grammar of Graphics</strong>.
{R} 內建許多繪圖工具函式,
這些繪圖工具可以顯示各種統計繪圖並且自建一些全新的圖.
{R} 繪圖工具函式之特色是用同一個繪圖函式, 對不同類型的物件,
可以作出不同的圖形.
繪圖工具函式既可互動式使用, 也可以批次處理使用.
在許多情況下, 使用互動式 (interactive)
執行 {R} 的圖形繪製, 是一個相當有效的方式.</p>
<p>{R} 基本繪圖工具包含 高階繪圖函式 與 低階繪圖函式, 或是合併二種方式形成互動式繪圖函式:</p>
<ul>
<li><strong>高階繪圖函式</strong>
(<strong>high-levlel plotting functions</strong>):
直接形成完整圖形, 圖形包括坐標軸, 標籤, 標題等等.</li>
<li><strong>低階繪圖函式</strong>
(<strong>low-level plotting functions</strong>):
是將 點, 線, 座標與標籤等逐步形成圖形.</li>
</ul>
<p>繪圖工具函式所產生之圖形結果,
無法指定成物件,
必須送到
<strong>圖形裝置</strong>
(<strong>graphic device</strong>),
圖形裝置可以是一個視窗或某一特定格式之圖形檔案,
{R} 可以將圖形儲存在各種圖形裝置,
包含 <code>pdf</code>, <code>ps</code>, <code>jpg</code>, <code>png</code> 檔案等等.</p>
<p>在 {R} 中還有有一個獨立的強大之繪圖系統,
<code>grid</code>
套件,
類似
Splus
裏的
<code>Trellis</code>
繪圖系統.
根據 <code>grid</code>
套件,
所建構的另一個較容易使用之
<code>lattice</code>,
<code>ggplot2</code> 等.
可以產生多重漂亮起專業的統計繪圖.
目前主流使用
<a href="https://www.tidyverse.org/">tidyverse 套件系統</a>
包含許多不同套件,
提供資料科學一些實用的函式,
其中 <code>ggplot2</code> 為視覺化分析套件.
以套件 <code>ggplot2</code> 為基礎, 已經衍生出許多其他繪圖套件.</p>
<div id="視覺化分析原則" class="section level2" number="5.1">
<h2><span class="header-section-number">5.1</span> 視覺化分析原則</h2>
<p>Edward Tufte (2006) 在 <a href="http://www.edwardtufte.com">Beautiful Evidence</a>
書中提出一些視覺化分析原則.</p>
<ul>
<li>顯示比較.</li>
<li>顯示因果關係或關聯性.</li>
<li>顯示多變量資料.</li>
<li>整合不同資料的證據.</li>
<li>描述與紀錄證據.</li>
<li>顯示實質內容最重要.</li>
</ul>
</div>
<div id="繪圖套件-ggplot2" class="section level2" number="5.2">
<h2><span class="header-section-number">5.2</span> 繪圖套件 ggplot2</h2>
<p>繪圖套件 <code>ggplot2</code> 是一個龐大的繪圖系統,
開始學習 <code>ggplot2</code> 的程式語言會有些困難,
但中等程度複雜的圖形, 使用 <code>ggplot2</code> 通常會比使用 R base 繪圖系統容易.
統計繪圖學習方式可從已經發表且有程式碼的圖形學起,
例如, <a href="https://www.r-graph-gallery.com/index.html" class="uri">https://www.r-graph-gallery.com/index.html</a>.</p>
<p><code>ggplot2</code> 的概念是使用結構性的語法,
先指定資料, 然後指定變數, 再指定幾何元素,
最後處裡標題與標注數據以及背景的主題式樣.
必要時考慮分組呈現相同圖形.
<code>ggplot2</code> 的概念如同繪畫, 可隨時
使用 <code>+</code> 加上圖層 (layers),
更新或取代原有圖層.</p>
<ul>
<li>data: 選取資料.</li>
<li>mapping (aes): 選取資料內變數進行對應或映射
<ul>
<li>x-變數, y-變數, treat, fill, shape, size, etc.</li>
</ul></li>
<li>geoms: 幾何物件 geometric object
<ul>
<li>point, line, bar, shapes, ribbon, polygon, smooth, text etc.</li>
</ul></li>
<li>stat: 計算統計量/變數轉換, statistics</li>
<li>position: 調整位置 position adjustments.</li>
</ul>
<p>Table: <code>ggplot2</code> 指令與引數</p>
<p>函式 <code>ggplot()</code> 基本程式如下.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="dataviz.html#cb63-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> data_name, </span>
<span id="cb63-2"><a href="dataviz.html#cb63-2" aria-hidden="true"></a>       <span class="kw">aes</span>(<span class="dt">x =</span> variable_name,</span>
<span id="cb63-3"><a href="dataviz.html#cb63-3" aria-hidden="true"></a>           <span class="dt">y =</span> variable_name,</span>
<span id="cb63-4"><a href="dataviz.html#cb63-4" aria-hidden="true"></a>           ... <span class="op">&lt;</span>other variable_name mappings<span class="op">&gt;</span>)) <span class="op">+</span></span>
<span id="cb63-5"><a href="dataviz.html#cb63-5" aria-hidden="true"></a><span class="st">  </span>geom_<span class="op">&lt;</span>type<span class="op">&gt;</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb63-6"><a href="dataviz.html#cb63-6" aria-hidden="true"></a><span class="st">  </span>...</span></code></pre></div>
<p>Prentice (1973) 報告一個研究,
關於年長退伍軍人罹患肺癌, 且無法接受手術之臨床試驗,
病患在榮民醫院隨機接受標準治療方法或新的化學治療方法,
比較治療的主要結果變數為死亡時間,
變數名稱列在表.
資料在檔案 <strong>survVATrial.csv</strong>.</p>
<table>
<thead>
<tr class="header">
<th>變數</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>treat (therapy)</td>
<td>治療組別: 0 = 標準; 1 = 新治療</td>
</tr>
<tr class="even">
<td>cellcode</td>
<td>細胞型態; 1 = 鱗狀細胞; 2 = 小細胞; 3 = 腺體細胞; 4 = 大細胞</td>
</tr>
<tr class="odd">
<td>time</td>
<td>存活時間, 診斷日期至死亡日期, 單位以日計</td>
</tr>
<tr class="even">
<td>censor</td>
<td>設限狀態: 0 = 設限; 1 = 死亡</td>
</tr>
<tr class="odd">
<td>kps</td>
<td>Karnofsky performance score, 診斷時身體狀態表現的分數</td>
</tr>
<tr class="even">
<td>diagtime</td>
<td>診斷到隨機分配的時間, 以月計</td>
</tr>
<tr class="odd">
<td>age</td>
<td>診斷時的年齡 (以年計)</td>
</tr>
<tr class="even">
<td>prior</td>
<td>先前是否接受治療; 0 = 無; 1 = 有</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="dataviz.html#cb64-1" aria-hidden="true"></a>dd &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="st">&quot;./Data/survVATrial.csv&quot;</span>,</span>
<span id="cb64-2"><a href="dataviz.html#cb64-2" aria-hidden="true"></a>                 <span class="dt">header =</span> <span class="ot">TRUE</span>,</span>
<span id="cb64-3"><a href="dataviz.html#cb64-3" aria-hidden="true"></a>                 <span class="dt">sep =</span> <span class="st">&quot;,&quot;</span>,</span>
<span id="cb64-4"><a href="dataviz.html#cb64-4" aria-hidden="true"></a>                 <span class="dt">quote =</span> <span class="st">&quot;</span><span class="ch">\&quot;</span><span class="st">&#39;&quot;</span>,</span>
<span id="cb64-5"><a href="dataviz.html#cb64-5" aria-hidden="true"></a>                 <span class="dt">dec =</span> <span class="st">&quot;.&quot;</span>,</span>
<span id="cb64-6"><a href="dataviz.html#cb64-6" aria-hidden="true"></a>                 <span class="dt">row.names =</span> <span class="ot">NULL</span>,</span>
<span id="cb64-7"><a href="dataviz.html#cb64-7" aria-hidden="true"></a>                 <span class="co"># col.names,</span></span>
<span id="cb64-8"><a href="dataviz.html#cb64-8" aria-hidden="true"></a>                 <span class="dt">as.is =</span> <span class="ot">TRUE</span>,</span>
<span id="cb64-9"><a href="dataviz.html#cb64-9" aria-hidden="true"></a>                 <span class="co"># as.is = !stringsAsFactors,</span></span>
<span id="cb64-10"><a href="dataviz.html#cb64-10" aria-hidden="true"></a>                 <span class="dt">na.strings =</span> <span class="kw">c</span>(<span class="st">&quot;.&quot;</span>, <span class="st">&quot;NA&quot;</span>))</span>
<span id="cb64-11"><a href="dataviz.html#cb64-11" aria-hidden="true"></a><span class="kw">head</span>(dd)</span>
<span id="cb64-12"><a href="dataviz.html#cb64-12" aria-hidden="true"></a><span class="co">##   treat cellcode time censor diagtime kps age prior</span></span>
<span id="cb64-13"><a href="dataviz.html#cb64-13" aria-hidden="true"></a><span class="co">## 1     0        1   72      1       60   7  69     0</span></span>
<span id="cb64-14"><a href="dataviz.html#cb64-14" aria-hidden="true"></a><span class="co">## 2     0        1  411      1       70   5  64    10</span></span>
<span id="cb64-15"><a href="dataviz.html#cb64-15" aria-hidden="true"></a><span class="co">## 3     0        1  228      1       60   3  38     0</span></span>
<span id="cb64-16"><a href="dataviz.html#cb64-16" aria-hidden="true"></a><span class="co">## 4     0        1  126      1       60   9  63    10</span></span>
<span id="cb64-17"><a href="dataviz.html#cb64-17" aria-hidden="true"></a><span class="co">## 5     0        1  118      1       70  11  65    10</span></span>
<span id="cb64-18"><a href="dataviz.html#cb64-18" aria-hidden="true"></a><span class="co">## 6     0        1   10      1       20   5  49     0</span></span>
<span id="cb64-19"><a href="dataviz.html#cb64-19" aria-hidden="true"></a><span class="kw">str</span>(dd)</span>
<span id="cb64-20"><a href="dataviz.html#cb64-20" aria-hidden="true"></a><span class="co">## &#39;data.frame&#39;:	137 obs. of  8 variables:</span></span>
<span id="cb64-21"><a href="dataviz.html#cb64-21" aria-hidden="true"></a><span class="co">##  $ treat   : int  0 0 0 0 0 0 0 0 0 0 ...</span></span>
<span id="cb64-22"><a href="dataviz.html#cb64-22" aria-hidden="true"></a><span class="co">##  $ cellcode: int  1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb64-23"><a href="dataviz.html#cb64-23" aria-hidden="true"></a><span class="co">##  $ time    : int  72 411 228 126 118 10 82 110 314 100 ...</span></span>
<span id="cb64-24"><a href="dataviz.html#cb64-24" aria-hidden="true"></a><span class="co">##  $ censor  : int  1 1 1 1 1 1 1 1 1 0 ...</span></span>
<span id="cb64-25"><a href="dataviz.html#cb64-25" aria-hidden="true"></a><span class="co">##  $ diagtime: int  60 70 60 60 70 20 40 80 50 70 ...</span></span>
<span id="cb64-26"><a href="dataviz.html#cb64-26" aria-hidden="true"></a><span class="co">##  $ kps     : int  7 5 3 9 11 5 10 29 18 6 ...</span></span>
<span id="cb64-27"><a href="dataviz.html#cb64-27" aria-hidden="true"></a><span class="co">##  $ age     : int  69 64 38 63 65 49 69 68 43 70 ...</span></span>
<span id="cb64-28"><a href="dataviz.html#cb64-28" aria-hidden="true"></a><span class="co">##  $ prior   : int  0 10 0 10 10 0 10 0 0 0 ...</span></span>
<span id="cb64-29"><a href="dataviz.html#cb64-29" aria-hidden="true"></a>dd<span class="op">$</span>treat &lt;-<span class="st"> </span><span class="kw">factor</span>(dd<span class="op">$</span>treat, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;placebo&quot;</span>, <span class="st">&quot;test&quot;</span>))</span>
<span id="cb64-30"><a href="dataviz.html#cb64-30" aria-hidden="true"></a>dd<span class="op">$</span>cellcode &lt;-<span class="st"> </span><span class="kw">factor</span>(dd<span class="op">$</span>cellcode, </span>
<span id="cb64-31"><a href="dataviz.html#cb64-31" aria-hidden="true"></a>                      <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;squamous&quot;</span>, <span class="st">&quot;small&quot;</span>, <span class="st">&quot;adeno&quot;</span>, <span class="st">&quot;large&quot;</span>))</span>
<span id="cb64-32"><a href="dataviz.html#cb64-32" aria-hidden="true"></a>dd<span class="op">$</span>censor &lt;-<span class="st"> </span><span class="kw">factor</span>(dd<span class="op">$</span>censor, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;survival&quot;</span>, <span class="st">&quot;dead&quot;</span>))</span>
<span id="cb64-33"><a href="dataviz.html#cb64-33" aria-hidden="true"></a>dd<span class="op">$</span>prior &lt;-<span class="st"> </span><span class="kw">factor</span>(dd<span class="op">$</span>prior, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;no&quot;</span>, <span class="st">&quot;yes&quot;</span>))</span>
<span id="cb64-34"><a href="dataviz.html#cb64-34" aria-hidden="true"></a><span class="kw">head</span>(dd)</span>
<span id="cb64-35"><a href="dataviz.html#cb64-35" aria-hidden="true"></a><span class="co">##     treat cellcode time censor diagtime kps age prior</span></span>
<span id="cb64-36"><a href="dataviz.html#cb64-36" aria-hidden="true"></a><span class="co">## 1 placebo squamous   72   dead       60   7  69    no</span></span>
<span id="cb64-37"><a href="dataviz.html#cb64-37" aria-hidden="true"></a><span class="co">## 2 placebo squamous  411   dead       70   5  64   yes</span></span>
<span id="cb64-38"><a href="dataviz.html#cb64-38" aria-hidden="true"></a><span class="co">## 3 placebo squamous  228   dead       60   3  38    no</span></span>
<span id="cb64-39"><a href="dataviz.html#cb64-39" aria-hidden="true"></a><span class="co">## 4 placebo squamous  126   dead       60   9  63   yes</span></span>
<span id="cb64-40"><a href="dataviz.html#cb64-40" aria-hidden="true"></a><span class="co">## 5 placebo squamous  118   dead       70  11  65   yes</span></span>
<span id="cb64-41"><a href="dataviz.html#cb64-41" aria-hidden="true"></a><span class="co">## 6 placebo squamous   10   dead       20   5  49    no</span></span>
<span id="cb64-42"><a href="dataviz.html#cb64-42" aria-hidden="true"></a><span class="kw">str</span>(dd)</span>
<span id="cb64-43"><a href="dataviz.html#cb64-43" aria-hidden="true"></a><span class="co">## &#39;data.frame&#39;:	137 obs. of  8 variables:</span></span>
<span id="cb64-44"><a href="dataviz.html#cb64-44" aria-hidden="true"></a><span class="co">##  $ treat   : Factor w/ 2 levels &quot;placebo&quot;,&quot;test&quot;: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb64-45"><a href="dataviz.html#cb64-45" aria-hidden="true"></a><span class="co">##  $ cellcode: Factor w/ 4 levels &quot;squamous&quot;,&quot;small&quot;,..: 1 1 1 1 1 1 1 1 1 1 ...</span></span>
<span id="cb64-46"><a href="dataviz.html#cb64-46" aria-hidden="true"></a><span class="co">##  $ time    : int  72 411 228 126 118 10 82 110 314 100 ...</span></span>
<span id="cb64-47"><a href="dataviz.html#cb64-47" aria-hidden="true"></a><span class="co">##  $ censor  : Factor w/ 2 levels &quot;survival&quot;,&quot;dead&quot;: 2 2 2 2 2 2 2 2 2 1 ...</span></span>
<span id="cb64-48"><a href="dataviz.html#cb64-48" aria-hidden="true"></a><span class="co">##  $ diagtime: int  60 70 60 60 70 20 40 80 50 70 ...</span></span>
<span id="cb64-49"><a href="dataviz.html#cb64-49" aria-hidden="true"></a><span class="co">##  $ kps     : int  7 5 3 9 11 5 10 29 18 6 ...</span></span>
<span id="cb64-50"><a href="dataviz.html#cb64-50" aria-hidden="true"></a><span class="co">##  $ age     : int  69 64 38 63 65 49 69 68 43 70 ...</span></span>
<span id="cb64-51"><a href="dataviz.html#cb64-51" aria-hidden="true"></a><span class="co">##  $ prior   : Factor w/ 2 levels &quot;no&quot;,&quot;yes&quot;: 1 2 1 2 2 1 2 1 1 1 ...</span></span></code></pre></div>
</div>
<div id="類別變數" class="section level2" number="5.3">
<h2><span class="header-section-number">5.3</span> 類別變數</h2>
<p>類別變數描述性統計主要是分析變數的
<strong>分配</strong>
或
<strong>分佈</strong>
(<strong>distribution</strong>),
分配敘述變數的觀測數值以及這些觀測數值出現的頻率.
類別變數描述性統計圖表常見為
頻率表 (frequency table),
長條圖 (bar plot) 與圓形圖 (pie chart).</p>
<p>對統計人員而言,
類別變數使用圓形圖呈現.
是非常不好的資料呈現方式,
使用頻率表 (Table) 或長條圖較佳.</p>
<div id="單一類別變數" class="section level3" number="5.3.1">
<h3><span class="header-section-number">5.3.1</span> 單一類別變數</h3>
<ul>
<li>單一類別變數: 檢視類別水準的頻率大小.</li>
</ul>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="dataviz.html#cb65-1" aria-hidden="true"></a><span class="co">## pie chart: ggplot2 do not have a simple geom_pie()</span></span>
<span id="cb65-2"><a href="dataviz.html#cb65-2" aria-hidden="true"></a><span class="co">## use R base pie()</span></span>
<span id="cb65-3"><a href="dataviz.html#cb65-3" aria-hidden="true"></a>cellcode.tab &lt;-<span class="st"> </span><span class="kw">table</span>(dd<span class="op">$</span>cellcode)</span>
<span id="cb65-4"><a href="dataviz.html#cb65-4" aria-hidden="true"></a>cellcode.tab</span>
<span id="cb65-5"><a href="dataviz.html#cb65-5" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb65-6"><a href="dataviz.html#cb65-6" aria-hidden="true"></a><span class="co">## squamous    small    adeno    large </span></span>
<span id="cb65-7"><a href="dataviz.html#cb65-7" aria-hidden="true"></a><span class="co">##       35       48       27       27</span></span>
<span id="cb65-8"><a href="dataviz.html#cb65-8" aria-hidden="true"></a><span class="kw">prop.table</span>(cellcode.tab)</span>
<span id="cb65-9"><a href="dataviz.html#cb65-9" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb65-10"><a href="dataviz.html#cb65-10" aria-hidden="true"></a><span class="co">## squamous    small    adeno    large </span></span>
<span id="cb65-11"><a href="dataviz.html#cb65-11" aria-hidden="true"></a><span class="co">##   0.2555   0.3504   0.1971   0.1971</span></span>
<span id="cb65-12"><a href="dataviz.html#cb65-12" aria-hidden="true"></a><span class="kw">round</span>(<span class="kw">prop.table</span>(cellcode.tab), <span class="dv">3</span>)</span>
<span id="cb65-13"><a href="dataviz.html#cb65-13" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb65-14"><a href="dataviz.html#cb65-14" aria-hidden="true"></a><span class="co">## squamous    small    adeno    large </span></span>
<span id="cb65-15"><a href="dataviz.html#cb65-15" aria-hidden="true"></a><span class="co">##    0.255    0.350    0.197    0.197</span></span>
<span id="cb65-16"><a href="dataviz.html#cb65-16" aria-hidden="true"></a><span class="kw">barplot</span>(cellcode.tab)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-1.png" width="432" /></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="dataviz.html#cb66-1" aria-hidden="true"></a><span class="kw">pie</span>(cellcode.tab)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-2.png" width="432" /></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="dataviz.html#cb67-1" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb67-2"><a href="dataviz.html#cb67-2" aria-hidden="true"></a><span class="co">## bar chart</span></span>
<span id="cb67-3"><a href="dataviz.html#cb67-3" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode)) <span class="op">+</span></span>
<span id="cb67-4"><a href="dataviz.html#cb67-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-3.png" width="432" /></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="dataviz.html#cb68-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode)) <span class="op">+</span></span>
<span id="cb68-2"><a href="dataviz.html#cb68-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb68-3"><a href="dataviz.html#cb68-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">coord_flip</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-4.png" width="432" /></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="dataviz.html#cb69-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">y =</span> cellcode)) <span class="op">+</span></span>
<span id="cb69-2"><a href="dataviz.html#cb69-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>) </span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-5.png" width="432" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="dataviz.html#cb70-1" aria-hidden="true"></a><span class="co"># pie chart: no simple solution</span></span>
<span id="cb70-2"><a href="dataviz.html#cb70-2" aria-hidden="true"></a>cell.freq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(cellcode.tab)</span>
<span id="cb70-3"><a href="dataviz.html#cb70-3" aria-hidden="true"></a><span class="kw">names</span>(cell.freq)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;cellcode&quot;</span></span>
<span id="cb70-4"><a href="dataviz.html#cb70-4" aria-hidden="true"></a>cell.freq</span>
<span id="cb70-5"><a href="dataviz.html#cb70-5" aria-hidden="true"></a><span class="co">##   cellcode Freq</span></span>
<span id="cb70-6"><a href="dataviz.html#cb70-6" aria-hidden="true"></a><span class="co">## 1 squamous   35</span></span>
<span id="cb70-7"><a href="dataviz.html#cb70-7" aria-hidden="true"></a><span class="co">## 2    small   48</span></span>
<span id="cb70-8"><a href="dataviz.html#cb70-8" aria-hidden="true"></a><span class="co">## 3    adeno   27</span></span>
<span id="cb70-9"><a href="dataviz.html#cb70-9" aria-hidden="true"></a><span class="co">## 4    large   27</span></span>
<span id="cb70-10"><a href="dataviz.html#cb70-10" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> cell.freq, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> cellcode)) <span class="op">+</span></span>
<span id="cb70-11"><a href="dataviz.html#cb70-11" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">width =</span> <span class="dv">1</span>, <span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb70-12"><a href="dataviz.html#cb70-12" aria-hidden="true"></a><span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-6.png" width="432" /></p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="dataviz.html#cb71-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> cell.freq, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> Freq, <span class="dt">fill =</span> cellcode)) <span class="op">+</span></span>
<span id="cb71-2"><a href="dataviz.html#cb71-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;identity&quot;</span>, <span class="dt">width =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb71-3"><a href="dataviz.html#cb71-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>, <span class="dt">start =</span> <span class="dv">0</span>) <span class="op">+</span></span>
<span id="cb71-4"><a href="dataviz.html#cb71-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">theme_void</span>() <span class="co"># remove background</span></span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-47-7.png" width="432" /></p>
</div>
<div id="多類別變數" class="section level3" number="5.3.2">
<h3><span class="header-section-number">5.3.2</span> 多類別變數</h3>
<ul>
<li>雙類別變數: 檢視變數聯合水準的頻率大小,
檢視條件水準的頻率大小.</li>
</ul>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="dataviz.html#cb72-1" aria-hidden="true"></a><span class="co">## two categorical vtriables</span></span>
<span id="cb72-2"><a href="dataviz.html#cb72-2" aria-hidden="true"></a><span class="kw">table</span>(dd<span class="op">$</span>treat)</span>
<span id="cb72-3"><a href="dataviz.html#cb72-3" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb72-4"><a href="dataviz.html#cb72-4" aria-hidden="true"></a><span class="co">## placebo    test </span></span>
<span id="cb72-5"><a href="dataviz.html#cb72-5" aria-hidden="true"></a><span class="co">##      69      68</span></span>
<span id="cb72-6"><a href="dataviz.html#cb72-6" aria-hidden="true"></a><span class="kw">table</span>(dd<span class="op">$</span>cellcode)</span>
<span id="cb72-7"><a href="dataviz.html#cb72-7" aria-hidden="true"></a><span class="co">## </span></span>
<span id="cb72-8"><a href="dataviz.html#cb72-8" aria-hidden="true"></a><span class="co">## squamous    small    adeno    large </span></span>
<span id="cb72-9"><a href="dataviz.html#cb72-9" aria-hidden="true"></a><span class="co">##       35       48       27       27</span></span>
<span id="cb72-10"><a href="dataviz.html#cb72-10" aria-hidden="true"></a>twoway.tab &lt;-<span class="st"> </span><span class="kw">table</span>(dd<span class="op">$</span>treat, dd<span class="op">$</span>cellcode)</span>
<span id="cb72-11"><a href="dataviz.html#cb72-11" aria-hidden="true"></a>twoway.tab</span>
<span id="cb72-12"><a href="dataviz.html#cb72-12" aria-hidden="true"></a><span class="co">##          </span></span>
<span id="cb72-13"><a href="dataviz.html#cb72-13" aria-hidden="true"></a><span class="co">##           squamous small adeno large</span></span>
<span id="cb72-14"><a href="dataviz.html#cb72-14" aria-hidden="true"></a><span class="co">##   placebo       15    30     9    15</span></span>
<span id="cb72-15"><a href="dataviz.html#cb72-15" aria-hidden="true"></a><span class="co">##   test          20    18    18    12</span></span>
<span id="cb72-16"><a href="dataviz.html#cb72-16" aria-hidden="true"></a><span class="co">## # cell proportion</span></span>
<span id="cb72-17"><a href="dataviz.html#cb72-17" aria-hidden="true"></a>cell.prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(twoway.tab, <span class="dt">margin =</span> <span class="ot">NULL</span>) </span>
<span id="cb72-18"><a href="dataviz.html#cb72-18" aria-hidden="true"></a><span class="kw">round</span>(cell.prop, <span class="dv">3</span>)</span>
<span id="cb72-19"><a href="dataviz.html#cb72-19" aria-hidden="true"></a><span class="co">##          </span></span>
<span id="cb72-20"><a href="dataviz.html#cb72-20" aria-hidden="true"></a><span class="co">##           squamous small adeno large</span></span>
<span id="cb72-21"><a href="dataviz.html#cb72-21" aria-hidden="true"></a><span class="co">##   placebo    0.109 0.219 0.066 0.109</span></span>
<span id="cb72-22"><a href="dataviz.html#cb72-22" aria-hidden="true"></a><span class="co">##   test       0.146 0.131 0.131 0.088</span></span>
<span id="cb72-23"><a href="dataviz.html#cb72-23" aria-hidden="true"></a><span class="co">## conditional on row sum to 1</span></span>
<span id="cb72-24"><a href="dataviz.html#cb72-24" aria-hidden="true"></a>cond_row_prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(twoway.tab, <span class="dt">margin =</span> <span class="dv">1</span>) </span>
<span id="cb72-25"><a href="dataviz.html#cb72-25" aria-hidden="true"></a><span class="kw">round</span>(cond_row_prop, <span class="dv">3</span>)</span>
<span id="cb72-26"><a href="dataviz.html#cb72-26" aria-hidden="true"></a><span class="co">##          </span></span>
<span id="cb72-27"><a href="dataviz.html#cb72-27" aria-hidden="true"></a><span class="co">##           squamous small adeno large</span></span>
<span id="cb72-28"><a href="dataviz.html#cb72-28" aria-hidden="true"></a><span class="co">##   placebo    0.217 0.435 0.130 0.217</span></span>
<span id="cb72-29"><a href="dataviz.html#cb72-29" aria-hidden="true"></a><span class="co">##   test       0.294 0.265 0.265 0.176</span></span>
<span id="cb72-30"><a href="dataviz.html#cb72-30" aria-hidden="true"></a><span class="kw">apply</span>(cond_row_prop, <span class="dv">1</span>, sum) <span class="co"># rows sum to 1</span></span>
<span id="cb72-31"><a href="dataviz.html#cb72-31" aria-hidden="true"></a><span class="co">## placebo    test </span></span>
<span id="cb72-32"><a href="dataviz.html#cb72-32" aria-hidden="true"></a><span class="co">##       1       1</span></span>
<span id="cb72-33"><a href="dataviz.html#cb72-33" aria-hidden="true"></a><span class="co">## conditional on column sum to 1</span></span>
<span id="cb72-34"><a href="dataviz.html#cb72-34" aria-hidden="true"></a>cond_col_prop &lt;-<span class="st"> </span><span class="kw">prop.table</span>(twoway.tab, <span class="dt">margin =</span> <span class="dv">2</span>) </span>
<span id="cb72-35"><a href="dataviz.html#cb72-35" aria-hidden="true"></a><span class="kw">round</span>(cond_col_prop, <span class="dv">3</span>)</span>
<span id="cb72-36"><a href="dataviz.html#cb72-36" aria-hidden="true"></a><span class="co">##          </span></span>
<span id="cb72-37"><a href="dataviz.html#cb72-37" aria-hidden="true"></a><span class="co">##           squamous small adeno large</span></span>
<span id="cb72-38"><a href="dataviz.html#cb72-38" aria-hidden="true"></a><span class="co">##   placebo    0.429 0.625 0.333 0.556</span></span>
<span id="cb72-39"><a href="dataviz.html#cb72-39" aria-hidden="true"></a><span class="co">##   test       0.571 0.375 0.667 0.444</span></span>
<span id="cb72-40"><a href="dataviz.html#cb72-40" aria-hidden="true"></a><span class="kw">apply</span>(cond_col_prop, <span class="dv">2</span>, sum) <span class="co"># cols sum to 1</span></span>
<span id="cb72-41"><a href="dataviz.html#cb72-41" aria-hidden="true"></a><span class="co">## squamous    small    adeno    large </span></span>
<span id="cb72-42"><a href="dataviz.html#cb72-42" aria-hidden="true"></a><span class="co">##        1        1        1        1</span></span>
<span id="cb72-43"><a href="dataviz.html#cb72-43" aria-hidden="true"></a><span class="co">## side-by-side bar plot</span></span>
<span id="cb72-44"><a href="dataviz.html#cb72-44" aria-hidden="true"></a><span class="kw">barplot</span>(twoway.tab, </span>
<span id="cb72-45"><a href="dataviz.html#cb72-45" aria-hidden="true"></a>        <span class="dt">beside =</span> <span class="ot">TRUE</span>, </span>
<span id="cb72-46"><a href="dataviz.html#cb72-46" aria-hidden="true"></a>        <span class="dt">main =</span> <span class="st">&quot;treat by cellcode&quot;</span>,</span>
<span id="cb72-47"><a href="dataviz.html#cb72-47" aria-hidden="true"></a>        <span class="dt">xlab =</span> <span class="st">&quot;cell type&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-1.png" width="432" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="dataviz.html#cb73-1" aria-hidden="true"></a><span class="co"># Stacked Bar Plot</span></span>
<span id="cb73-2"><a href="dataviz.html#cb73-2" aria-hidden="true"></a><span class="kw">barplot</span>(twoway.tab,</span>
<span id="cb73-3"><a href="dataviz.html#cb73-3" aria-hidden="true"></a>        <span class="dt">beside =</span> <span class="ot">FALSE</span>, </span>
<span id="cb73-4"><a href="dataviz.html#cb73-4" aria-hidden="true"></a>        <span class="dt">main =</span> <span class="st">&quot;treat by cellcode&quot;</span>,</span>
<span id="cb73-5"><a href="dataviz.html#cb73-5" aria-hidden="true"></a>        <span class="dt">xlab =</span> <span class="st">&quot;cell type&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-2.png" width="432" /></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="dataviz.html#cb74-1" aria-hidden="true"></a><span class="co">## ggplot2</span></span>
<span id="cb74-2"><a href="dataviz.html#cb74-2" aria-hidden="true"></a><span class="co">## Automatically stack</span></span>
<span id="cb74-3"><a href="dataviz.html#cb74-3" aria-hidden="true"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb74-4"><a href="dataviz.html#cb74-4" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode, <span class="dt">fill =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb74-5"><a href="dataviz.html#cb74-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-3.png" width="432" /></p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="dataviz.html#cb75-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb75-2"><a href="dataviz.html#cb75-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;stack&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-4.png" width="432" /></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="dataviz.html#cb76-1" aria-hidden="true"></a><span class="co">## side-by-side </span></span>
<span id="cb76-2"><a href="dataviz.html#cb76-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode, <span class="dt">fill =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb76-3"><a href="dataviz.html#cb76-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-5.png" width="432" /></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="dataviz.html#cb77-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> cellcode, <span class="dt">fill =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb77-2"><a href="dataviz.html#cb77-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">position =</span> <span class="st">&quot;fill&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-48-6.png" width="432" /></p>
</div>
</div>
<div id="連續變數" class="section level2" number="5.4">
<h2><span class="header-section-number">5.4</span> 連續變數</h2>
<p>連續變數描述性統計主要是分析變數的
<strong>分配</strong>
或
<strong>分佈</strong>
(<strong>distribution</strong>),
分配敘述變數的觀測數值以及這些觀測數值出現的頻率.
連續變數描述性統計圖表常見為
點狀圖 (dot plot), 枝葉圖 (stem-and-leaf),
次數分配表, 直方圖 (histogram), 盒鬚圖 (box plot),
密度圖 (density plot), 平均值, 變異數等.
對連續變數的描述, 若樣本數較少,
常使用點狀圖或枝葉圖.
目前多數為大數據, 點狀圖或枝葉圖較少使用,
但在實驗設計的數據呈現仍然非常重要.</p>
<div id="單連續變數" class="section level3" number="5.4.1">
<h3><span class="header-section-number">5.4.1</span> 單連續變數</h3>
<ul>
<li>單連續變數: 檢視中央趨勢, 離散程度 偏度, 峰度.</li>
</ul>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="dataviz.html#cb78-1" aria-hidden="true"></a><span class="co">## use R base pie()</span></span>
<span id="cb78-2"><a href="dataviz.html#cb78-2" aria-hidden="true"></a><span class="co">## histogram</span></span>
<span id="cb78-3"><a href="dataviz.html#cb78-3" aria-hidden="true"></a><span class="kw">hist</span>(dd<span class="op">$</span>time, </span>
<span id="cb78-4"><a href="dataviz.html#cb78-4" aria-hidden="true"></a>     <span class="dt">freq =</span> <span class="ot">TRUE</span>,    </span>
<span id="cb78-5"><a href="dataviz.html#cb78-5" aria-hidden="true"></a>     <span class="dt">main =</span> <span class="st">&quot;time histogram&quot;</span>,</span>
<span id="cb78-6"><a href="dataviz.html#cb78-6" aria-hidden="true"></a>     <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-1.png" width="432" /></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="dataviz.html#cb79-1" aria-hidden="true"></a><span class="kw">hist</span>(dd<span class="op">$</span>time, </span>
<span id="cb79-2"><a href="dataviz.html#cb79-2" aria-hidden="true"></a>     <span class="dt">freq =</span> <span class="ot">FALSE</span>,    </span>
<span id="cb79-3"><a href="dataviz.html#cb79-3" aria-hidden="true"></a>     <span class="dt">main =</span> <span class="st">&quot;time histogram&quot;</span>,</span>
<span id="cb79-4"><a href="dataviz.html#cb79-4" aria-hidden="true"></a>     <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-2.png" width="432" /></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="dataviz.html#cb80-1" aria-hidden="true"></a><span class="co"># box plot</span></span>
<span id="cb80-2"><a href="dataviz.html#cb80-2" aria-hidden="true"></a><span class="kw">boxplot</span>(dd<span class="op">$</span>time, </span>
<span id="cb80-3"><a href="dataviz.html#cb80-3" aria-hidden="true"></a>        <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-3.png" width="432" /></p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="dataviz.html#cb81-1" aria-hidden="true"></a><span class="co"># QQ plot</span></span>
<span id="cb81-2"><a href="dataviz.html#cb81-2" aria-hidden="true"></a><span class="kw">qqnorm</span>(dd<span class="op">$</span>time, </span>
<span id="cb81-3"><a href="dataviz.html#cb81-3" aria-hidden="true"></a>       <span class="dt">main =</span> <span class="st">&quot;Normal QQ Plot: time&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-4.png" width="432" /></p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="dataviz.html#cb82-1" aria-hidden="true"></a><span class="co"># density plot</span></span>
<span id="cb82-2"><a href="dataviz.html#cb82-2" aria-hidden="true"></a><span class="kw">plot</span>(<span class="kw">density</span>(dd<span class="op">$</span>time),</span>
<span id="cb82-3"><a href="dataviz.html#cb82-3" aria-hidden="true"></a>     <span class="dt">pch =</span> <span class="dv">16</span>,</span>
<span id="cb82-4"><a href="dataviz.html#cb82-4" aria-hidden="true"></a>     <span class="dt">main =</span> <span class="st">&quot;Density Plot&quot;</span>,</span>
<span id="cb82-5"><a href="dataviz.html#cb82-5" aria-hidden="true"></a>     <span class="dt">xlab =</span> <span class="st">&quot;time&quot;</span>,</span>
<span id="cb82-6"><a href="dataviz.html#cb82-6" aria-hidden="true"></a>     <span class="dt">ylab =</span> <span class="st">&quot;density&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-5.png" width="432" /></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="dataviz.html#cb83-1" aria-hidden="true"></a><span class="co">## ggplot2 </span></span>
<span id="cb83-2"><a href="dataviz.html#cb83-2" aria-hidden="true"></a><span class="co">## histogram</span></span>
<span id="cb83-3"><a href="dataviz.html#cb83-3" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb83-4"><a href="dataviz.html#cb83-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-6.png" width="432" /></p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="dataviz.html#cb84-1" aria-hidden="true"></a><span class="co">## box plot</span></span>
<span id="cb84-2"><a href="dataviz.html#cb84-2" aria-hidden="true"></a><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb84-3"><a href="dataviz.html#cb84-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-7.png" width="432" /></p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="dataviz.html#cb85-1" aria-hidden="true"></a><span class="co">## violin plot</span></span>
<span id="cb85-2"><a href="dataviz.html#cb85-2" aria-hidden="true"></a><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(<span class="dt">x =</span> <span class="st">&quot;&quot;</span>, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb85-3"><a href="dataviz.html#cb85-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_violin</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-8.png" width="432" /></p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="dataviz.html#cb86-1" aria-hidden="true"></a><span class="co">## density plot</span></span>
<span id="cb86-2"><a href="dataviz.html#cb86-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb86-3"><a href="dataviz.html#cb86-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_freqpoly</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-9.png" width="432" /></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="dataviz.html#cb87-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb87-2"><a href="dataviz.html#cb87-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">stat_bin</span>(<span class="dt">geom =</span> <span class="st">&quot;area&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-10.png" width="432" /></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="dataviz.html#cb88-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb88-2"><a href="dataviz.html#cb88-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">stat_bin</span>(<span class="dt">geom =</span> <span class="st">&quot;line&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-49-11.png" width="432" /></p>
</div>
<div id="二連續變數" class="section level3" number="5.4.2">
<h3><span class="header-section-number">5.4.2</span> 二連續變數</h3>
<ul>
<li>散佈圖 <strong>scatter plot</strong> = X &amp; Y = 連續變數</li>
<li>雙連續變數: 檢視二個變數關聯性, 大小, 方向, 趨勢.</li>
</ul>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="dataviz.html#cb89-1" aria-hidden="true"></a><span class="co">## R base</span></span>
<span id="cb89-2"><a href="dataviz.html#cb89-2" aria-hidden="true"></a><span class="co">## scatter plot</span></span>
<span id="cb89-3"><a href="dataviz.html#cb89-3" aria-hidden="true"></a><span class="co">## basic</span></span>
<span id="cb89-4"><a href="dataviz.html#cb89-4" aria-hidden="true"></a><span class="kw">plot</span>(<span class="dt">x =</span> dd<span class="op">$</span>diagtime, <span class="dt">y =</span> dd<span class="op">$</span>time)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-1.png" width="432" /></p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="dataviz.html#cb90-1" aria-hidden="true"></a><span class="co">## formula y ~ x, data = data_name)</span></span>
<span id="cb90-2"><a href="dataviz.html#cb90-2" aria-hidden="true"></a><span class="kw">plot</span>(time <span class="op">~</span><span class="st"> </span>diagtime, <span class="dt">data =</span> dd)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-2.png" width="432" /></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="dataviz.html#cb91-1" aria-hidden="true"></a><span class="co">## ggplot</span></span>
<span id="cb91-2"><a href="dataviz.html#cb91-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb91-3"><a href="dataviz.html#cb91-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-3.png" width="432" /></p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="dataviz.html#cb92-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb92-2"><a href="dataviz.html#cb92-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-4.png" width="432" /></p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="dataviz.html#cb93-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb93-2"><a href="dataviz.html#cb93-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>() </span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-5.png" width="432" /></p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="dataviz.html#cb94-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb94-2"><a href="dataviz.html#cb94-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>) </span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-6.png" width="432" /></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="dataviz.html#cb95-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb95-2"><a href="dataviz.html#cb95-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">5</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb95-3"><a href="dataviz.html#cb95-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_rug</span>(<span class="dt">col =</span> <span class="st">&quot;steelblue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.1</span>, <span class="dt">size =</span> <span class="fl">1.5</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-7.png" width="432" /></p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="dataviz.html#cb96-1" aria-hidden="true"></a><span class="co"># add linear line or smoothing line</span></span>
<span id="cb96-2"><a href="dataviz.html#cb96-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb96-3"><a href="dataviz.html#cb96-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb96-4"><a href="dataviz.html#cb96-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-8.png" width="432" /></p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="dataviz.html#cb97-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb97-2"><a href="dataviz.html#cb97-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb97-3"><a href="dataviz.html#cb97-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-9.png" width="432" /></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="dataviz.html#cb98-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-2"><a href="dataviz.html#cb98-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-3"><a href="dataviz.html#cb98-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb98-4"><a href="dataviz.html#cb98-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span>
<span id="cb98-5"><a href="dataviz.html#cb98-5" aria-hidden="true"></a><span class="co">## scatter plot + marginal distribution</span></span>
<span id="cb98-6"><a href="dataviz.html#cb98-6" aria-hidden="true"></a><span class="kw">library</span>(ggExtra)</span>
<span id="cb98-7"><a href="dataviz.html#cb98-7" aria-hidden="true"></a><span class="co"># classical</span></span>
<span id="cb98-8"><a href="dataviz.html#cb98-8" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span></span>
<span id="cb98-9"><a href="dataviz.html#cb98-9" aria-hidden="true"></a><span class="st">      </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb98-10"><a href="dataviz.html#cb98-10" aria-hidden="true"></a><span class="st">      </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span>
<span id="cb98-11"><a href="dataviz.html#cb98-11" aria-hidden="true"></a><span class="co"># scatter plot + marginal histogram</span></span>
<span id="cb98-12"><a href="dataviz.html#cb98-12" aria-hidden="true"></a><span class="kw">ggMarginal</span>(p, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>)</span>
<span id="cb98-13"><a href="dataviz.html#cb98-13" aria-hidden="true"></a><span class="co"># scatter plot + marginal density</span></span>
<span id="cb98-14"><a href="dataviz.html#cb98-14" aria-hidden="true"></a><span class="kw">ggMarginal</span>(p, <span class="dt">type =</span> <span class="st">&quot;density&quot;</span>)</span>
<span id="cb98-15"><a href="dataviz.html#cb98-15" aria-hidden="true"></a><span class="co"># scatter plot + marginal boxplot</span></span>
<span id="cb98-16"><a href="dataviz.html#cb98-16" aria-hidden="true"></a><span class="kw">ggMarginal</span>(p, <span class="dt">type =</span> <span class="st">&quot;boxplot&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-50-10.png" width="432" /></p>
</div>
<div id="三連續變數" class="section level3" number="5.4.3">
<h3><span class="header-section-number">5.4.3</span> 三連續變數</h3>
<ul>
<li>多連續變數: 檢視成對變數關聯性, 大小, 方向, 趨勢.</li>
</ul>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="dataviz.html#cb99-1" aria-hidden="true"></a><span class="co">## pairwise scatter plot</span></span>
<span id="cb99-2"><a href="dataviz.html#cb99-2" aria-hidden="true"></a><span class="co">## R base</span></span>
<span id="cb99-3"><a href="dataviz.html#cb99-3" aria-hidden="true"></a>con.df =<span class="st"> </span>dd[, <span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;diagtime&quot;</span>, <span class="st">&quot;kps&quot;</span>, <span class="st">&quot;age&quot;</span>)]</span>
<span id="cb99-4"><a href="dataviz.html#cb99-4" aria-hidden="true"></a>cor.mat =<span class="st"> </span><span class="kw">cor</span>(con.df, <span class="dt">use =</span> <span class="st">&quot;complete&quot;</span>, <span class="dt">method =</span> <span class="st">&quot;pearson&quot;</span>)</span>
<span id="cb99-5"><a href="dataviz.html#cb99-5" aria-hidden="true"></a><span class="kw">round</span>(cor.mat, <span class="dv">3</span>)</span>
<span id="cb99-6"><a href="dataviz.html#cb99-6" aria-hidden="true"></a><span class="co">##            time diagtime    kps    age</span></span>
<span id="cb99-7"><a href="dataviz.html#cb99-7" aria-hidden="true"></a><span class="co">## time      1.000    0.382 -0.046 -0.068</span></span>
<span id="cb99-8"><a href="dataviz.html#cb99-8" aria-hidden="true"></a><span class="co">## diagtime  0.382    1.000 -0.184 -0.095</span></span>
<span id="cb99-9"><a href="dataviz.html#cb99-9" aria-hidden="true"></a><span class="co">## kps      -0.046   -0.184  1.000 -0.033</span></span>
<span id="cb99-10"><a href="dataviz.html#cb99-10" aria-hidden="true"></a><span class="co">## age      -0.068   -0.095 -0.033  1.000</span></span>
<span id="cb99-11"><a href="dataviz.html#cb99-11" aria-hidden="true"></a><span class="kw">pairs</span>(con.df)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-1.png" width="432" /></p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="dataviz.html#cb100-1" aria-hidden="true"></a><span class="co">## ggplot2</span></span>
<span id="cb100-2"><a href="dataviz.html#cb100-2" aria-hidden="true"></a><span class="kw">library</span>(GGally)</span>
<span id="cb100-3"><a href="dataviz.html#cb100-3" aria-hidden="true"></a>GGally<span class="op">::</span><span class="kw">ggpairs</span>(<span class="dt">data =</span> con.df)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-2.png" width="432" /></p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="dataviz.html#cb101-1" aria-hidden="true"></a>GGally<span class="op">::</span><span class="kw">ggcorr</span>(<span class="dt">data =</span> con.df, </span>
<span id="cb101-2"><a href="dataviz.html#cb101-2" aria-hidden="true"></a>               <span class="dt">method =</span> <span class="kw">c</span>(<span class="st">&quot;complete&quot;</span>, <span class="st">&quot;pearson&quot;</span>))</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-3.png" width="432" /></p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="dataviz.html#cb102-1" aria-hidden="true"></a><span class="co">## Correlogram</span></span>
<span id="cb102-2"><a href="dataviz.html#cb102-2" aria-hidden="true"></a><span class="kw">library</span>(corrgram)</span>
<span id="cb102-3"><a href="dataviz.html#cb102-3" aria-hidden="true"></a><span class="kw">corrgram</span>(<span class="dt">x =</span> dd, </span>
<span id="cb102-4"><a href="dataviz.html#cb102-4" aria-hidden="true"></a>         <span class="dt">order =</span> <span class="ot">TRUE</span>, </span>
<span id="cb102-5"><a href="dataviz.html#cb102-5" aria-hidden="true"></a>         <span class="dt">lower.panel =</span> panel.shade, </span>
<span id="cb102-6"><a href="dataviz.html#cb102-6" aria-hidden="true"></a>         <span class="dt">upper.panel =</span> panel.pie, </span>
<span id="cb102-7"><a href="dataviz.html#cb102-7" aria-hidden="true"></a>         <span class="dt">text.panel =</span> panel.txt, </span>
<span id="cb102-8"><a href="dataviz.html#cb102-8" aria-hidden="true"></a>         <span class="dt">main =</span> <span class="st">&quot;1. VA Lung Cancer Trial&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-4.png" width="432" /></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="dataviz.html#cb103-1" aria-hidden="true"></a><span class="kw">corrgram</span>(<span class="dt">x =</span> dd, </span>
<span id="cb103-2"><a href="dataviz.html#cb103-2" aria-hidden="true"></a>         <span class="dt">order =</span> <span class="ot">TRUE</span>, </span>
<span id="cb103-3"><a href="dataviz.html#cb103-3" aria-hidden="true"></a>         <span class="dt">lower.panel =</span> panel.ellipse, </span>
<span id="cb103-4"><a href="dataviz.html#cb103-4" aria-hidden="true"></a>         <span class="dt">upper.panel =</span> panel.pts, </span>
<span id="cb103-5"><a href="dataviz.html#cb103-5" aria-hidden="true"></a>         <span class="dt">text.panel =</span> panel.minmax, </span>
<span id="cb103-6"><a href="dataviz.html#cb103-6" aria-hidden="true"></a>         <span class="dt">main =</span> <span class="st">&quot;2. VA Lung Cancer Trial&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-5.png" width="432" /></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="dataviz.html#cb104-1" aria-hidden="true"></a><span class="kw">corrgram</span>(<span class="dt">x =</span> dd, </span>
<span id="cb104-2"><a href="dataviz.html#cb104-2" aria-hidden="true"></a>         <span class="dt">order =</span> <span class="ot">NULL</span>, </span>
<span id="cb104-3"><a href="dataviz.html#cb104-3" aria-hidden="true"></a>         <span class="dt">lower.panel =</span> panel.shade, </span>
<span id="cb104-4"><a href="dataviz.html#cb104-4" aria-hidden="true"></a>         <span class="dt">upper.panel =</span> <span class="ot">NULL</span>, </span>
<span id="cb104-5"><a href="dataviz.html#cb104-5" aria-hidden="true"></a>         <span class="dt">text.panel =</span> panel.txt, </span>
<span id="cb104-6"><a href="dataviz.html#cb104-6" aria-hidden="true"></a>         <span class="dt">main =</span> <span class="st">&quot;3. VA Lung Cancer Trial&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-51-6.png" width="432" /></p>
</div>
</div>
<div id="混合變數" class="section level2" number="5.5">
<h2><span class="header-section-number">5.5</span> 混合變數</h2>
<p>多變量視覺化分析</p>
<ul>
<li>一連續 + 一類別</li>
<li>二連續 + 一類別</li>
<li>二類別 + 一連續 = 一連續 + 一類別</li>
<li>多變數</li>
</ul>
<div id="一連續-一類別" class="section level3" number="5.5.1">
<h3><span class="header-section-number">5.5.1</span> 一連續 + 一類別</h3>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="dataviz.html#cb105-1" aria-hidden="true"></a><span class="co"># one continuous + one categorical</span></span>
<span id="cb105-2"><a href="dataviz.html#cb105-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb105-3"><a href="dataviz.html#cb105-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> treat))</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-1.png" width="432" /></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="dataviz.html#cb106-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb106-2"><a href="dataviz.html#cb106-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>( <span class="dt">color =</span> <span class="st">&quot;#e9ecef&quot;</span>, </span>
<span id="cb106-3"><a href="dataviz.html#cb106-3" aria-hidden="true"></a>                    <span class="dt">alpha =</span> <span class="fl">0.6</span>, </span>
<span id="cb106-4"><a href="dataviz.html#cb106-4" aria-hidden="true"></a>                    <span class="dt">position =</span> <span class="st">&#39;identity&#39;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-2.png" width="432" /></p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="dataviz.html#cb107-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> time, <span class="dt">color =</span> treat, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb107-2"><a href="dataviz.html#cb107-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_histogram</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-3.png" width="432" /></p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="dataviz.html#cb108-1" aria-hidden="true"></a><span class="co"># side-by-side boxplot</span></span>
<span id="cb108-2"><a href="dataviz.html#cb108-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> treat, <span class="dt">y =</span> time, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb108-3"><a href="dataviz.html#cb108-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-4.png" width="432" /></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="dataviz.html#cb109-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> treat, <span class="dt">y =</span> time, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb109-2"><a href="dataviz.html#cb109-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb109-3"><a href="dataviz.html#cb109-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-5.png" width="432" /></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="dataviz.html#cb110-1" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb110-2"><a href="dataviz.html#cb110-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> treat, <span class="dt">y =</span> time, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb110-3"><a href="dataviz.html#cb110-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_violin</span>()</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-6.png" width="432" /></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="dataviz.html#cb111-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> treat, <span class="dt">y =</span> time, <span class="dt">fill =</span> treat)) <span class="op">+</span></span>
<span id="cb111-2"><a href="dataviz.html#cb111-2" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_violin</span>() <span class="op">+</span></span>
<span id="cb111-3"><a href="dataviz.html#cb111-3" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_jitter</span>(<span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">alpha =</span> <span class="fl">0.8</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb111-4"><a href="dataviz.html#cb111-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Violin chart by treatment&quot;</span>) <span class="op">+</span></span>
<span id="cb111-5"><a href="dataviz.html#cb111-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;treatment&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-52-7.png" width="432" /></p>
</div>
<div id="二連續-一類別" class="section level3" number="5.5.2">
<h3><span class="header-section-number">5.5.2</span> 二連續 + 一類別</h3>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="dataviz.html#cb112-1" aria-hidden="true"></a><span class="co">## ggplot2</span></span>
<span id="cb112-2"><a href="dataviz.html#cb112-2" aria-hidden="true"></a><span class="co">## two continuous + one categorical</span></span>
<span id="cb112-3"><a href="dataviz.html#cb112-3" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">color =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb112-4"><a href="dataviz.html#cb112-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-1.png" width="432" /></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="dataviz.html#cb113-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">color =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb113-2"><a href="dataviz.html#cb113-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-2.png" width="432" /></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="dataviz.html#cb114-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, </span>
<span id="cb114-2"><a href="dataviz.html#cb114-2" aria-hidden="true"></a>                      <span class="dt">color =</span> treat, <span class="dt">shape =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb114-3"><a href="dataviz.html#cb114-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>,  <span class="dt">size =</span> <span class="dv">3</span>) </span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-3.png" width="432" /></p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="dataviz.html#cb115-1" aria-hidden="true"></a><span class="co"># add linear line or smoothing line</span></span>
<span id="cb115-2"><a href="dataviz.html#cb115-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, </span>
<span id="cb115-3"><a href="dataviz.html#cb115-3" aria-hidden="true"></a>                      <span class="dt">color =</span> treat, <span class="dt">shape =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb115-4"><a href="dataviz.html#cb115-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb115-5"><a href="dataviz.html#cb115-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-4.png" width="432" /></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="dataviz.html#cb116-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, </span>
<span id="cb116-2"><a href="dataviz.html#cb116-2" aria-hidden="true"></a>                      <span class="dt">color =</span> treat, <span class="dt">shape =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb116-3"><a href="dataviz.html#cb116-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb116-4"><a href="dataviz.html#cb116-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-5.png" width="432" /></p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="dataviz.html#cb117-1" aria-hidden="true"></a><span class="co">#</span></span>
<span id="cb117-2"><a href="dataviz.html#cb117-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time,</span>
<span id="cb117-3"><a href="dataviz.html#cb117-3" aria-hidden="true"></a>                      <span class="dt">color =</span> treat, <span class="dt">shape =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb117-4"><a href="dataviz.html#cb117-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb117-5"><a href="dataviz.html#cb117-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-6.png" width="432" /></p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="dataviz.html#cb118-1" aria-hidden="true"></a><span class="co"># BAD! too many lines</span></span>
<span id="cb118-2"><a href="dataviz.html#cb118-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time,</span>
<span id="cb118-3"><a href="dataviz.html#cb118-3" aria-hidden="true"></a>                      <span class="dt">color =</span> treat, <span class="dt">shape =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb118-4"><a href="dataviz.html#cb118-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">alpha =</span> <span class="dv">1</span><span class="op">/</span><span class="dv">2</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb118-5"><a href="dataviz.html#cb118-5" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb118-6"><a href="dataviz.html#cb118-6" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">se =</span> <span class="ot">FALSE</span>)</span>
<span id="cb118-7"><a href="dataviz.html#cb118-7" aria-hidden="true"></a><span class="co"># classical</span></span>
<span id="cb118-8"><a href="dataviz.html#cb118-8" aria-hidden="true"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">color =</span> treat)) <span class="op">+</span></span>
<span id="cb118-9"><a href="dataviz.html#cb118-9" aria-hidden="true"></a><span class="st">      </span><span class="kw">geom_point</span>(<span class="dt">size =</span> <span class="dv">5</span>) </span>
<span id="cb118-10"><a href="dataviz.html#cb118-10" aria-hidden="true"></a><span class="co"># scatter plot + marginal histogram</span></span>
<span id="cb118-11"><a href="dataviz.html#cb118-11" aria-hidden="true"></a>ggExtra<span class="op">::</span><span class="kw">ggMarginal</span>(p, <span class="dt">type =</span> <span class="st">&quot;histogram&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;purple&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-53-7.png" width="432" /></p>
<ul>
<li>Try by yourself!</li>
</ul>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="dataviz.html#cb119-1" aria-hidden="true"></a><span class="co"># more advanced</span></span>
<span id="cb119-2"><a href="dataviz.html#cb119-2" aria-hidden="true"></a>my_fn &lt;-<span class="st"> </span><span class="cf">function</span>(data, mapping, ...){</span>
<span id="cb119-3"><a href="dataviz.html#cb119-3" aria-hidden="true"></a>  p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> data, <span class="dt">mapping =</span> mapping) <span class="op">+</span><span class="st"> </span></span>
<span id="cb119-4"><a href="dataviz.html#cb119-4" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb119-5"><a href="dataviz.html#cb119-5" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> loess, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">fill =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, ...) <span class="op">+</span></span>
<span id="cb119-6"><a href="dataviz.html#cb119-6" aria-hidden="true"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> lm, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">color =</span> <span class="st">&quot;blue&quot;</span>, ...)</span>
<span id="cb119-7"><a href="dataviz.html#cb119-7" aria-hidden="true"></a>  p</span>
<span id="cb119-8"><a href="dataviz.html#cb119-8" aria-hidden="true"></a>}</span>
<span id="cb119-9"><a href="dataviz.html#cb119-9" aria-hidden="true"></a>GGally<span class="op">::</span><span class="kw">ggpairs</span>(<span class="dt">data =</span> con.df, </span>
<span id="cb119-10"><a href="dataviz.html#cb119-10" aria-hidden="true"></a>        <span class="dt">lower =</span> <span class="kw">list</span>(<span class="dt">continuous =</span> my_fn))</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-54-1.png" width="432" /></p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="dataviz.html#cb120-1" aria-hidden="true"></a><span class="co">## Bubble plot</span></span>
<span id="cb120-2"><a href="dataviz.html#cb120-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">size =</span> age)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb120-3"><a href="dataviz.html#cb120-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb120-4"><a href="dataviz.html#cb120-4" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">15</span>), <span class="dt">name =</span> <span class="st">&quot;Age Bubbles&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-55-1.png" width="432" /></p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="dataviz.html#cb121-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">size =</span> age)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb121-2"><a href="dataviz.html#cb121-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb121-3"><a href="dataviz.html#cb121-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">15</span>), <span class="dt">name =</span> <span class="st">&quot;Age Bubbles&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-55-2.png" width="432" /></p>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="dataviz.html#cb122-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time, <span class="dt">size =</span> age, <span class="dt">color =</span> treat)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-2"><a href="dataviz.html#cb122-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb122-3"><a href="dataviz.html#cb122-3" aria-hidden="true"></a><span class="kw">scale_size</span>(<span class="dt">range =</span> <span class="kw">c</span>(.<span class="dv">1</span>, <span class="dv">24</span>), <span class="dt">name =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-55-3.png" width="432" /></p>
</div>
</div>
<div id="分組繪圖" class="section level2" number="5.6">
<h2><span class="header-section-number">5.6</span> 分組繪圖</h2>
<ul>
<li>將資料依據組別分割成子資料集</li>
<li>將每個子資料集繪製在不同的圖格</li>
<li>將所有子資料集的圖格合併呈現</li>
</ul>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="dataviz.html#cb123-1" aria-hidden="true"></a><span class="co"># plot by treat</span></span>
<span id="cb123-2"><a href="dataviz.html#cb123-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb123-3"><a href="dataviz.html#cb123-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>treat)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-56-1.png" width="432" /></p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="dataviz.html#cb124-1" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb124-2"><a href="dataviz.html#cb124-2" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(treat <span class="op">~</span><span class="st"> </span>.)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-56-2.png" width="432" /></p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="dataviz.html#cb125-1" aria-hidden="true"></a><span class="co"># plot by cellcode</span></span>
<span id="cb125-2"><a href="dataviz.html#cb125-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb125-3"><a href="dataviz.html#cb125-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>cellcode)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-56-3.png" width="432" /></p>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="dataviz.html#cb126-1" aria-hidden="true"></a><span class="co"># two factors</span></span>
<span id="cb126-2"><a href="dataviz.html#cb126-2" aria-hidden="true"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> dd, <span class="kw">aes</span>(<span class="dt">x =</span> diagtime, <span class="dt">y =</span> time)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_jitter</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb126-3"><a href="dataviz.html#cb126-3" aria-hidden="true"></a><span class="st">  </span><span class="kw">facet_grid</span>(treat <span class="op">~</span><span class="st"> </span>cellcode)</span></code></pre></div>
<p><img src="r4biost_files/figure-html/unnamed-chunk-56-4.png" width="432" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datainout.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="basicfunctiuon.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "PMingLiU",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["r4biost.pdf", "r4biost.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
